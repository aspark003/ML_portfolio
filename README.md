Fraud Detection & Anomaly Detection System

An end-to-end machine learning system using PCA, DBSCAN, OPTICS, and HDBSCAN to detect anomalies, assign fraud risk categories, and generate explainable outputs.
Integrated with an enterprise-style Power BI dashboard for real-time monitoring, KPIs, and automated alerts.

Project Overview

This project builds a full anomaly detection pipeline designed to identify fraudulent or unusual vendor transactions.
Using a combination of dimensionality reduction, density-based clustering, and risk scoring, this system creates a multi-model fraud assessment that mimics real-world enterprise fraud detection engines.

Key Machine Learning Components
1. Data Preprocessing

Numerical scaling using MinMaxScaler

One-hot encoding for categorical fields

ColumnTransformer pipeline for reproducibility

ID columns added for Power BI integration

2. Dimensionality Reduction: PCA

PCA with 11 components

Variance and cumulative variance exported for visualization

Embedding space used for all clustering models

3. Clustering Models
DBSCAN

Detects dense clusters and flags anomalies where label = -1

Generates:

DBSCAN labels

DBSCAN identifier (0/1)

DBSCAN category (“OUTLIER”, “NOT OUTLIER”)

Exports pca_db_file.csv, cluster_db_scores.csv

OPTICS

Uses reachability and ordering to define structure

Generates:

Reachability plots

OPTICS labels and identifiers

4-level risk categories via quantiles

Exports optics_risk.csv, optics_score.csv

HDBSCAN

Hierarchical density clustering

Produces soft cluster membership probabilities

Generates:

Probabilities for each point

HDBSCAN labels

HDBSCAN identifier

Risk levels (“critical” → “stable”)

Exports hd_probability.csv, hd_scores.csv

Final Combined Risk Engine

The system produces a final fraud signal using all three models:

total identifier = DBSCAN + OPTICS + HDBSCAN
total category risk = {0: low, 1: medium, 2: high, 3: critical}


This creates a unified anomaly score for use in dashboards and workflows.

Power BI Dashboard Integration

A complete interactive dashboard is built to visualize:

Fraud severity levels

PCA variance + cumulative variance

DBSCAN clusters

OPTICS reachability

HDBSCAN probability distribution

Risk categories

Final fraud score

Cards tracking fraud volume and severity

Automated alerts for high-risk anomalies

Technologies Used

Python: pandas, numpy, sklearn

Machine Learning: PCA, DBSCAN, OPTICS, HDBSCAN

Data Engineering: Pipelines, ColumnTransformer

How to Run
python main_pipeline.py

Enter:

d → Run DBSCAN

o → Run OPTICS

h → Run HDBSCAN

f → Generate final fraud risk file

Power BI Dashboard Integration

This Power BI dashboard uses the output files generated by the Python anomaly detection pipeline and transforms them into an interactive fraud-monitoring system used for model evaluation and real-time anomaly investigation.

Dashboard Pages
- PCA Variance View** – visualizes variance and cumulative variance from `var_cumsum.csv`.
- DBSCAN Clustering View** – shows outliers and clusters from `pca_db_file.csv`.
- OPTICS Reachability View** – displays reachability, ordering, and risk categories from `optics_risk.csv`.
- HDBSCAN Probability View** – maps probability-based risk levels from `hd_probability.csv`.
- Final Risk Score View** – visualizes total identifiers and final severity levels using `final.csv`.

Key Dashboard Features
- Cards for anomaly counts and risk levels  
- Outlier vs. non-outlier filtering  
- Trend and distribution analysis  
- Real-time alerting for critical anomalies  

Purpose
This dashboard completes the full ML→BI workflow by taking the machine learning outputs and transforming them into a visual analytics tool that supports fraud analysis, decision-making, and model explainability.

Power BI Visuals (PDF)
[Click here to view the Power BI dashboard screenshots](agency_fraud_screenshot.pdf)



Full Fraud Detection Pipeline Script (DBSCAN • OPTICS • HDBSCAN)

This project includes a complete anomaly-detection pipeline written in Python that processes government invoice data using three unsupervised clustering algorithms:

DBSCAN (density-based outlier detection)

OPTICS (reachability and ordering analysis)

HDBSCAN (probability-based anomaly scoring)

The script automatically:

1. Preprocesses the data

Cleans headers

Removes date columns

Separates numerical & categorical features

Applies MinMaxScaler and OneHotEncoder

Builds a unified preprocessing pipeline

2. Runs PCA (4 Components)

Generates PCA coordinates

Exports:

pca_file.csv

variance_cumulative.csv

3. Performs DBSCAN Outlier Detection

Exports:

p_dbscan_scores.csv

dbscan_outliers.csv

Adds:

DBSCAN labels

Outlier identifiers

Outlier categories

4. Performs OPTICS Reachability Analysis

Exports:

reachability_ordering.csv

optics_reach_scores.csv

gov_final.csv (with reachability identifiers + risk categories)

Adds:

Reachability

Ordering

Reachability risk categories (low → critical)

5. Performs HDBSCAN Probability Analysis

Exports:

hdbscan_prob_category.csv

gov_hdbscan.csv

gov_hd_probability_scores.csv

Adds:

Probability scores

Probability risk categories

HDBSCAN identifiers

6. Creates the Final Risk File

Exports:

gov_total.csv

Adds:

Combined anomaly score from DBSCAN + OPTICS + HDBSCAN

Final risk category:

0 → stable

1 → low

2 → medium

3 → critical

How to Run the Script
python gov_pipeline.py


Then enter:

d → Run DBSCAN

o → Run OPTICS

h → Run HDBSCAN

f → Generate the final combined risk file

Example:

Enter model name here: d

Output Files Overview
File	Description
pca_file.csv	PCA coordinates + DBSCAN labels
variance_cumulative.csv	PCA variance + cumsum
dbscan_outliers.csv	DBSCAN label + identifier + outlier category
p_dbscan_scores.csv	Silhouette / Calinski / Davies scores
reachability_ordering.csv	OPTICS reachability + ordering
optics_reach_scores.csv	OPTICS cluster metrics
hdbscan_prob_category.csv	HDBSCAN probability + category
gov_hdbscan.csv	All features merged with HDBSCAN outputs
gov_total.csv	Final combined risk level

Power BI Fraud Detection Dashboard

This project includes a full operational fraud-detection dashboard built in Microsoft Power BI.
The dashboard consumes the output files generated by the Python pipeline (DBSCAN, OPTICS, HDBSCAN, PCA, final risk).

The dashboard transforms raw anomaly-detection results into interactive risk analytics for real-world monitoring.

Dashboard Overview

The dashboard consists of four main analytical pages:

PCA + DBSCAN Dashboard

Shows:

PCA scatter plot (PC1–PC4 reduced features)

DBSCAN cluster labels (0, 1, 2…)

Outlier identification (label = -1)

Outlier categories (outlier / not outlier)

PCA variance and cumulative variance

DBSCAN Silhouette, Calinski, Davies metrics

Purpose:
Helps visualize density-based anomalies and evaluate cluster quality.

2️OPTICS Reachability Dashboard

Shows:

Reachability plot

Reachability ordering

Cluster assignments

Outlier identifiers

Risk categories (low → medium → high → critical)

OPTICS metric scores

Purpose:
Provides a hierarchical view of anomalies using reachability distances.

HDBSCAN Probability Dashboard

Shows:

Outlier probability distribution

Probability-based risk categories
(critical, high, medium, low)

Cluster persistence

HDBSCAN metric scores

Purpose:
Assigns severity-based risk levels using probability instead of distance alone.

Final Combined Fraud Dashboard

Shows:

Total risk score from DBSCAN + OPTICS + HDBSCAN

Final risk category:

Stable

Low

Medium

Critical

Summary cards (# of invoices in each category)

Vendor drill-down

Invoice-level anomaly inspection

Ability to filter by any original feature

Purpose:
This is the operational dashboard used for real investigation and monitoring.

Dashboard Files in This Repo

Place these files inside your /powerbi/ folder:

dbscan_dashboard.pbix

optics_dashboard.pbix

hdbscan_dashboard.pbix

final_fraud_dashboard.pbix

You may rename them to match your preferred naming standard.

How the Dashboard Connects to Python

Each page uses data generated by the script:

Power BI Visual	Python Output File
PCA Scatter	pca_file.csv
PCA Variance	variance_cumulative.csv
DBSCAN Outliers	dbscan_outliers.csv
DBSCAN Metrics	p_dbscan_scores.csv
OPTICS Reachability	reachability_ordering.csv
OPTICS Metrics	optics_reach_scores.csv
HDBSCAN Probability	hdbscan_prob_category.csv
Final Risk File	gov_total.csv

This shows recruiters that your dashboard is fully integrated with your machine learning pipeline.

How to Open the Dashboard

Download any .pbix file from /powerbi/

Open it in Power BI Desktop (Free)

Use the slicers and visuals to explore anomalies and risk severity

Why This Dashboard Is Powerful

Combines three clustering algorithms for multi-layer accuracy

Uses PCA to reduce noise and improve interpretability

Provides severity scoring (critical → low → stable)

Includes operational insights (vendor, invoice, description-level analysis)

Designed exactly like enterprise fraud-detection tools

Shows your ability to integrate Python ML + BI analytics

[Open Final Fraud Dashboard (PBIX)](powerbi/final_fraud_dashboard.pbix)



By:
Antonio Park
Retired U.S. Marine Corps Program Manager - Machine Learning Engineer
Focused on fraud detection, anomaly detection, automation, and dashboard analytics.
